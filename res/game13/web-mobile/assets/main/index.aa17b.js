window.__require=function e(t,n,i){function a(o,r){if(!n[o]){if(!t[o]){var c=o.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!r&&l)return l(c,!0);if(s)return s(c,!0);throw new Error("Cannot find module '"+o+"'")}o=c}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){return a(t[o][1][e]||e)},d,d.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof __require&&__require,o=0;o<i.length;o++)a(i[o]);return a}({AnimCallback:[function(e,t){"use strict";cc._RF.push(t,"c3507nEqh9ET4zm7r/ZOTsj","AnimCallback");var n=e("./Game");cc.Class({extends:cc.Component,onAnimCompleted:function(e){"readygo"===e?n.instance.onReadyGoCompleted():"perfect"===e&&n.instance.onPerfectAnimCompleted(this.node)}}),cc._RF.pop()},{"./Game":"Game"}],AppMain:[function(e,t){"use strict";cc._RF.push(t,"e257dF6dMBE+J8NRY2pBxYw","AppMain");var n=e("./GameDef"),i=(a(e("./VideoRecord")),a(e("./Platform")));function a(e){return e&&e.__esModule?e:{default:e}}var s=e("./DataStorage"),o=e("./Audio"),r=cc.Class({extends:cc.Component,properties:{platformName:{default:n.GamePlatform.Normal,type:cc.Enum(n.GamePlatform)},language:{default:n.Language.ZH,type:cc.Enum(n.Language)},coinPrefab:{default:null,type:cc.Prefab}},statics:{instance:null},onLoad:function(){r.instance=this,cc.game.addPersistRootNode(this.node),this.screenSize=cc.view.getVisibleSize(),this.designResolutionWidth=cc.Canvas.instance.designResolution.width,console.log("screen width="+this.screenSize.width+" height="+this.screenSize.height),console.log("design resolution width="+this.designResolutionWidth),this.screenHalfWidth=.5*this.screenSize.width,this.screenHalfHeight=.5*this.screenSize.height,this.gameState=n.GameState.MainMenu,this.gameStarted=!1,this.TTGAME=!1,this.firstPlay=!1,this.bestScore=0,this.nickName="",this.avatarUrl="",this.coin=n.GameConfig.DefaultCoinNum,this.videoShareDate=0,this.videoAdCallback=null,this.dailyAwardChecked=!1,this.timerShowInterstitial=-1,this.loseCount=0,this.platformOnLoad()},xmlHttpRequest:function(e,t){var n=cc.loader.getXMLHttpRequest();n.open("POST",e,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.setRequestHeader("Miniuid",r.instance.platform.uid),n.onreadystatechange=function(){4===n.readyState&&n.status>=200&&n.status<300&&(n.responseText,console.log("XMLHttpRequest status="+n.status+" res="+n.responseText))};var i=JSON.stringify(t);n.send(i)},decidePlatform:function(){},platformOnLoad:function(){this.platform=new i.default,this.platform.uidCheck(),this.recorder=null,this.videoAd=null,this.bannerAd=null,this.TTGAME},TryShowInterstitialOnLose:function(){this.loseCount+=1,this.loseCount>=3&&(this.loseCount=0,this.DelayShowInterstitialOnLose())},DelayShowInterstitialOnLose:function(){clearTimeout(this.timerShowInterstitial);var e=this.getRandomInteger(500,1e3),t=this;this.timerShowInterstitial=setTimeout(function(){t.ShowInterstitial()},e)},DelayShowInterstitial:function(){clearTimeout(this.timerShowInterstitial);var e=this.getRandomInteger(600,1100),t=this;this.timerShowInterstitial=setTimeout(function(){t.ShowInterstitial()},e)},ShowInterstitial:function(){var e=window;void 0!==window.parent&&(e=window.parent),"function"==typeof e.ShowADForLayaGame&&(cc.game.pause(),e.ShowADForLayaGame(!1,"browse",function(){cc.game.resume()}))},getRandomInteger:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},playVideoAd:function(e){var t=window;void 0!==window.parent&&(t=window.parent),"function"==typeof t.ShowADForLayaGame?(cc.game.pause(),t.ShowADForLayaGame(!0,"reward",function(){cc.game.resume(),e&&e()})):e&&e()},createBannerAd:function(){},hideBannerAd:function(){},showBannerAd:function(){},destroyBannerAd:function(){},createNewDataStorage:function(){console.log("create New DataStorage");var e={firstPlay:!0,bestScore:0,snd:"on",nickName:"",avatarUrl:""};e.coin=n.GameConfig.DefaultCoinNum,e.videoShareDate=0,this.firstPlay=!0,this.bestScore=0,o.instance.snd="on",this.nickName="",this.avatarUrl="",this.coin=n.GameConfig.DefaultCoinNum,this.videoShareDate=0,s.save("data.dat",e)},saveDataStorage:function(){var e={};e.firstPlay=this.firstPlay,e.bestScore=this.bestScore,e.snd=o.instance.sndOn,e.nickName=this.nickName,e.avatarUrl=this.avatarUrl,e.coin=this.coin,e.videoShareDate=this.videoShareDate,s.save("data.dat",e)},loadDataStorage:function(){if(s.dataExist("data.dat")){var e=s.load("data.dat");this.firstPlay=e.firstPlay,this.bestScore=e.bestScore,o.instance.sndOn=e.snd,this.nickName=e.nickName,this.avatarUrl=e.avatarUrl,this.coin=e.coin,this.videoShareDate=e.videoShareDate}else this.createNewDataStorage()},addCoin:function(e,t,n){var i=this;if(this.coin+=e,this.coin<0&&(this.coin=0),this.saveDataStorage(),e>0){var a=cc.Canvas.instance.node.getChildByName("coinEffect");this.schedule(function(){var e=cc.instantiate(i.coinPrefab),s=t.convertToWorldSpaceAR(cc.v2(0,0)),o=a.convertToNodeSpace(s);a.addChild(e),e.setPosition(o),s=n.convertToWorldSpaceAR(cc.v2(0,0));var r=a.convertToNodeSpace(s),c=cc.sequence(cc.moveTo(.25,r),cc.callFunc(function(e){e.destroy()}));e.runAction(c)},.1,7,0)}},setVideoShareDate:function(e){this.videoShareDate=e,this.saveDataStorage()},setFirstPlay:function(e){this.firstPlay=e,this.saveDataStorage()},start:function(){this.loadDataStorage()}});cc._RF.pop()},{"./Audio":"Audio","./DataStorage":"DataStorage","./GameDef":"GameDef","./Platform":"Platform","./VideoRecord":"VideoRecord"}],Audio:[function(e,t){"use strict";cc._RF.push(t,"d48bcA5hVBJUp++2WIDrkEE","Audio");var n=cc.Class({extends:cc.Component,properties:{bgMusic:{default:null,type:cc.AudioClip},acReadyGo:{default:null,type:cc.AudioClip},acFall:{default:null,type:cc.AudioClip},acHold:{default:null,type:cc.AudioClip},acHoldPerfect:{default:null,type:cc.AudioClip},acHoldFail:{default:null,type:cc.AudioClip},acFallWater:{default:null,type:cc.AudioClip},acInWater:{default:null,type:cc.AudioClip},sndOn:{default:"on",visible:!1}},statics:{instance:null},onLoad:function(){n.instance=this,cc.game.addPersistRootNode(this.node)},playBgMusic:function(e){e?"on"===this.sndOn&&cc.audioEngine.playMusic(this.bgMusic,!0):cc.audioEngine.stopMusic()},playReadyGo:function(){"on"===this.sndOn&&cc.audioEngine.play(this.acReadyGo,!1,1)},playFall:function(){"on"===this.sndOn&&cc.audioEngine.play(this.acFall,!1,1)},playHold:function(){"on"===this.sndOn&&cc.audioEngine.play(this.acHold,!1,.5)},playHoldPerfect:function(){"on"===this.sndOn&&cc.audioEngine.play(this.acHoldPerfect,!1,1)},playHoldFail:function(){"on"===this.sndOn&&cc.audioEngine.play(this.acHoldFail,!1,1)},playFallWater:function(){"on"===this.sndOn&&cc.audioEngine.play(this.acFallWater,!1,1)},playInWater:function(){"on"===this.sndOn&&cc.audioEngine.play(this.acInWater,!1,1)},stopAll:function(){cc.audioEngine.stopAll()}});cc._RF.pop()},{}],CoinEffect:[function(e,t){"use strict";cc._RF.push(t,"34179MuxxNP+4eiwHjUDx7z","CoinEffect");var n,i=(n=e("./Util"))&&n.__esModule?n:{default:n};cc.Class({extends:cc.Component,properties:{coinPrefab:{default:null,type:cc.Prefab}},start:function(){var e=this;this.schedule(function(){var t=cc.instantiate(e.coinPrefab),n=i.default.randRangeNumber(-20,20),a=i.default.randRangeNumber(-20,20);e.node.addChild(t),t.setPosition(n,a)},.02,30,0)}}),cc._RF.pop()},{"./Util":"Util"}],DailyAwardPage:[function(e,t){"use strict";cc._RF.push(t,"866a69RQl1H8pyA/tIgfMG1","DailyAwardPage");var n=e("./DataStorage"),i=e("./AppMain");cc.Class({extends:cc.Component,properties:{contentNode:{default:null,type:cc.Node},doubleAwardToggle:{default:null,type:cc.Toggle},awardCoinNodes:{default:[],type:[cc.Node]},getAwardBtn:{default:null,type:cc.Button}},onLoad:function(){this.dailyAwardLastDate=0,this.dailyAwardDay=-1,this.canGetAward=!1,this.awardValues=[300,400,400,500,500,600,800],this.forceOpen=!1,this.mainMenu=this.node.parent.getComponent("MainMenu"),this.pageInFade=!1},start:function(){},showDailyAwardPanel:function(e){if(void 0===e&&(e=!1),!this.pageInFade)if(this.getAwardBtn.interactable=!0,this.forceOpen=e,this.loadDailyAwardData(),this.doubleAwardToggle.check(),0===this.dailyAwardLastDate)this.show(),this.canGetAward=!0,this.updateStateDisplay();else{var t=new Date,n=t.getFullYear(),i=t.getMonth(),a=t.getDate(),s=new Date(this.dailyAwardLastDate),o=s.getFullYear(),r=s.getMonth(),c=s.getDate();o!==n||r!==i||c!==a?(this.show(),this.canGetAward=!0,this.updateStateDisplay()):e?(this.show(),this.canGetAward=!1,this.updateStateDisplay()):(this.contentNode.active=!1,this.canGetAward=!1,this.mainMenu.showMainMenu(!0))}},updateStateDisplay:function(){for(var e=this.contentNode.getChildByName("awards"),t=0;t<e.childrenCount;t++){var n=e.children[t].getChildByName("iconCheck");this.dailyAwardDay>=t?n.active=!0:n.active=!1}var i=this.contentNode.getChildByName("getAwardBtn");this.canGetAward?(i.children[0].active=!0,i.children[1].active=!1):(i.children[0].active=!1,i.children[1].active=!0)},loadDailyAwardData:function(){if(n.dataExist("awardData")){var e=n.load("awardData");this.dailyAwardLastDate=e.date,this.dailyAwardDay=e.day}else this.dailyAwardLastDate=0,this.dailyAwardDay=-1},saveDailyAwardData:function(){this.dailyAwardLastDate=Date.now(),n.save("awardData",{date:this.dailyAwardLastDate,day:this.dailyAwardDay})},show:function(){var e=this;if(!this.pageInFade){this.contentNode.active=!0,this.pageInFade=!0,this.contentNode.scale=.4,this.contentNode.opacity=0;var t=cc.fadeTo(.3,255);this.contentNode.runAction(t);var n=cc.scaleTo(.3,1,1).easing(cc.easeBackOut()),i=cc.sequence(n,cc.callFunc(function(){e.pageInFade=!1}));this.contentNode.runAction(i)}},hide:function(){var e=this;if(!this.pageInFade){this.pageInFade=!0;var t=cc.scaleTo(.3,.4,.4).easing(cc.easeBackIn()),n=cc.sequence(t,cc.callFunc(function(){e.contentNode.active=!1,e.forceOpen?e.mainMenu.showMainMenuDirectly():e.mainMenu.showMainMenu(!0),e.pageInFade=!1})),i=cc.fadeTo(.3,0);this.contentNode.runAction(n),this.contentNode.runAction(i)}},onGetAwardBtnClicked:function(){var e=this;this.canGetAward&&i.instance.playVideoAd(function(){console.log("\u767b\u5f55\u53cc\u500d\u5956\u52b1\u9886\u53d6"),e.getAward(2)})},getAward:function(e){var t=this;void 0===e&&(e=1),this.dailyAwardDay++,this.dailyAwardDay>=this.awardValues.length&&(this.dailyAwardDay=0);var n=this.awardValues[this.dailyAwardDay]*e,a=this.mainMenu.coinLabel.node.parent.getChildByName("goldIcon");i.instance.addCoin(n,this.awardCoinNodes[this.dailyAwardDay],a),this.mainMenu.updateCoinLabel(),this.saveDailyAwardData(),this.getAwardBtn.interactable=!1,this.scheduleOnce(function(){t.hide()},.8)}}),cc._RF.pop()},{"./AppMain":"AppMain","./DataStorage":"DataStorage"}],DataStorage:[function(e,t){"use strict";cc._RF.push(t,"2d089LPCeBJ2J+j6pV6qJUO","DataStorage");var n={dataExist:function(e){return CC_WECHATGAME?0!==wx.getStorageSync(e).length:null!==cc.sys.localStorage.getItem(e)},save:function(e,t){CC_WECHATGAME?wx.setStorageSync(e,t):cc.sys.localStorage.setItem(e,JSON.stringify(t))},load:function(e){if(CC_WECHATGAME){var t=wx.getStorageSync(e);if(0!==t.length)return t}else{var n=cc.sys.localStorage.getItem(e);if(null!==n)return JSON.parse(n)}return null},dataExistInFile:function(e){var t=wx.getFileSystemManager();try{var n=wx.env.USER_DATA_PATH+"/"+e;return t.accessSync(n),!0}catch(i){return!1}return!1},saveToFile:function(e,t){var n=wx.getFileSystemManager(),i=wx.env.USER_DATA_PATH+"/"+e;try{n.writeFileSync(i,JSON.stringify(t),"utf8")}catch(a){console.log("err="+a.toString())}},loadFromFile:function(e){var t=wx.getFileSystemManager(),n=wx.env.USER_DATA_PATH+"/"+e,i=t.readFileSync(n,"utf8");return JSON.parse(i)}};t.exports=n,cc._RF.pop()},{}],GameDef:[function(e,t,n){"use strict";cc._RF.push(t,"8ea21xKO0dAybc+4rO8Qyms","GameDef"),n.__esModule=!0,n.Language=n.GameState=n.GamePlatform=n.GameConfig=n.ApiUrl=n.AdKey=void 0,n.GameState={MainMenu:0,GameEndless:1},n.GameConfig={DefaultCoinNum:300,ReliveTimesLimit:2,RelivePrice:600,RelivePrice2:700,VideoShareCoinAward:800};var i=cc.Enum({ZH:0,EN:1});n.Language=i;var a=cc.Enum({Normal:0,TTGame:1,WECHAT:2,QQPlay:3});n.GamePlatform=a,n.ApiUrl={ActivateUrl:"",UpdateScoreUrl:"",GetRankUrl:""},n.AdKey={videoAd:"",bannerAd:""},cc._RF.pop()},{}],Game:[function(e,t){"use strict";cc._RF.push(t,"84306FhHERLGI4tuekMReyF","Game"),e("./GameDef");var n=i(e("./Util"));function i(e){return e&&e.__esModule?e:{default:e}}i(e("./Stone")),i(e("./Platform")),i(e("./VideoRecord"));var a=e("./Audio"),s=(e("./DataStorage"),e("./AppMain")),o=cc.Class({extends:cc.Component,properties:{selfPlayerNode:{default:null,type:cc.Node},scoreLabel:{default:null,type:cc.Label},readyGoAnim:{default:null,type:cc.Animation},stonesNode:{default:null,type:cc.Node},stonePrefabs:{default:[],type:[cc.Prefab]},crackStonePrefab:{default:null,type:cc.Prefab},stripesNode:{default:null,type:cc.Node},stripePrefabs:{default:[],type:[cc.Prefab]},marksNode:{default:null,type:cc.Node},markPrefabs:{default:[],type:[cc.Prefab]},spotsNode:{default:null,type:cc.Node},spotPrefabs:{default:[],type:[cc.Prefab]},totemsNode:{default:null,type:cc.Node},totemPrefabs:{default:[],type:[cc.Prefab]},plantsNode:{default:null,type:cc.Node},plantsPrefabs:{default:[],type:[cc.Prefab]},crackEffectNode:{default:null,type:cc.Node},crackEffectPrefab:{default:null,type:cc.Prefab},perfectEffectNode:{default:null,type:cc.Node},perfectEffectPrefab:{default:null,type:cc.Prefab},splashEffect0:{default:null,type:cc.ParticleSystem},splashEffect1:{default:null,type:cc.ParticleSystem},shareBtn:{default:null,type:cc.Node},replayBtn:{default:null,type:cc.Node},resultPanel:{default:null,type:cc.Node},guideText1:{default:null,type:cc.Node},guideText2:{default:null,type:cc.Node},guideTapAnim:{default:null,type:cc.Animation},guidePointerAnim:{default:null,type:cc.Animation},waterNode:{default:null,type:cc.Node},waterBubble:{default:null,type:cc.ParticleSystem},newRecordEffects:{default:[],type:[cc.ParticleSystem]},resultPanelNode:{default:null,type:cc.Node},coinLabel:{default:null,type:cc.Label},selfPlayer:{default:null,type:cc.Component,visible:!1}},statics:{instance:null},onLoad:function(){o.instance=this,this.reliveTimes=0,this.water=this.waterNode.getComponent("Water"),this.water2=this.waterNode.parent.getChildByName("water2").getComponent("Water"),this.resultPanel=this.resultPanelNode.getComponent("ResultPanel"),this.areaStartYPos=-s.instance.screenHalfHeight,this.elapsedTime=0,this.levelStones=[],this.stoneIndex=0,this.stoneStartIndex=0,this.lastTrunkStoneIndex=0,this.stripeLastYPos=0,this.stoneMinX=0,this.stoneMinY=0,this.stoneMaxX=0,this.stoneMaxY=0,this.branchStoneOdds=0,this.holdDistance=60,this.rotateRadius=250,this.perfectHoldDis=40,this.a2r=.017453293,this.stoneScaleParams=[.5,.6,.6,.7,.7,.7,.8,.8,.8],this.initObjectPool(),this.node.parent.on(cc.Node.EventType.TOUCH_START,this.touchStartCallback,this.node),this.node.parent.on(cc.Node.EventType.TOUCH_END,this.touchEndCallback,this.node)},initObjectPool:function(){console.log("############ initObjectPool"),this.stoneSprites=[];for(var e=0;e<this.stonePrefabs.length;e++){var t=cc.instantiate(this.stonePrefabs[e]);this.stoneSprites.push(t.getComponent(cc.Sprite))}this.stoneObjPool=new cc.NodePool;for(var n=0;n<150;n++){var i=cc.instantiate(this.stonePrefabs[0]);this.stoneObjPool.put(i)}this.crackStoneObjPool=new cc.NodePool;for(var a=0;a<30;a++){var s=cc.instantiate(this.crackStonePrefab);this.crackStoneObjPool.put(s)}this.stripeSprites=[];for(var o=0;o<this.stripePrefabs.length;o++){var r=cc.instantiate(this.stripePrefabs[o]);this.stripeSprites.push(r.getComponent(cc.Sprite))}this.stripeObjPool=new cc.NodePool;for(var c=0;c<150;c++){var l=cc.instantiate(this.stripePrefabs[0]);this.stripeObjPool.put(l)}this.markSprites=[];for(var d=0;d<this.markPrefabs.length;d++){var h=cc.instantiate(this.markPrefabs[d]);this.markSprites.push(h.getComponent(cc.Sprite))}this.markObjPool=new cc.NodePool;for(var u=0;u<50;u++){var p=cc.instantiate(this.markPrefabs[0]);this.markObjPool.put(p)}this.spotSprites=[];for(var f=0;f<this.spotPrefabs.length;f++){var g=cc.instantiate(this.spotPrefabs[f]);this.spotSprites.push(g.getComponent(cc.Sprite))}this.spotObjPool=new cc.NodePool;for(var m=0;m<150;m++){var v=cc.instantiate(this.spotPrefabs[0]);this.spotObjPool.put(v)}this.totemSprites=[];for(var S=0;S<this.totemPrefabs.length;S++){var y=cc.instantiate(this.totemPrefabs[S]);this.totemSprites.push(y.getComponent(cc.Sprite))}this.totemObjPool=new cc.NodePool;for(var P=0;P<50;P++){var b=cc.instantiate(this.totemPrefabs[0]);this.totemObjPool.put(b)}this.plantSprites=[];for(var N=0;N<this.plantsPrefabs.length;N++){var w=cc.instantiate(this.plantsPrefabs[N]);this.plantSprites.push(w.getComponent(cc.Sprite))}this.plantObjPool=new cc.NodePool;for(var C=0;C<100;C++){var A=cc.instantiate(this.plantsPrefabs[0]);this.plantObjPool.put(A)}this.perfectEffectPool=new cc.NodePool;for(var R=0;R<6;R++){var x=cc.instantiate(this.perfectEffectPrefab);this.perfectEffectPool.put(x)}this.crackEffectPool=new cc.NodePool;for(var M=0;M<12;M++){var D=cc.instantiate(this.crackEffectPrefab);this.crackEffectPool.put(D)}},getStonePos:function(e){return cc.v2(this.levelStones[e].xpos-s.instance.screenHalfWidth,this.levelStones[e].ypos-s.instance.screenHalfHeight)},perfectHold:function(){var e=this.selfPlayer.holdStoneId;if(!this.levelStones[e].perfected){this.levelStones[e].perfected=!0;var t=this.perfectEffectPool.get();this.perfectEffectNode.addChild(t);var n=this.getStonePos(e);t.setPosition(n),t.getComponent(cc.Animation).play(),a.instance.playHoldPerfect();var i=this.crackEffectPool.get();this.crackEffectNode.addChild(i),i.setPosition(n),i.setScale(this.levelStones[e].scale,this.levelStones[e].scale),i.getComponent(cc.Animation).play()}},disGuidePointer:function(){var e=this.selfPlayer.holdStoneId+1,t=this.getStonePos(e);this.guidePointerAnim.node.active=!0,this.guidePointerAnim.node.setPosition(t),this.guidePointerAnim.play()},getWaterHeight:function(){return this.water.getHeight()},setWaterHeight:function(e){this.water.setHeight(e),this.water2.setHeight(e)},updateCoinLabel:function(){this.coinLabel.string=""+s.instance.coin},playSplashEffect:function(e){this.splashEffect0.node.parent.active=!0;var t=this.stonesNode.parent.convertToNodeSpace(cc.v2(e.x,e.y));this.splashEffect0.node.parent.setPosition(t),this.splashEffect0.resetSystem(),this.splashEffect1.resetSystem()},start:function(){this.updateCoinLabel(),CC_WECHATGAME&&wx.onShareAppMessage(function(){return{title:"\u6211\u5728\u73a9\u5ced\u58c1\u9003\u4ea1\uff0c\u8fd9\u6e38\u620f\u7cbe\u5f69\u523a\u6fc0\uff0c\u4f60\u4e5f\u5feb\u6765\u6311\u6218\u5427\uff01",imageUrl:"http://47.106.104.176:3010/image/panyanShare.jpg",query:""}}),this.selfPlayer=this.selfPlayerNode.getComponent("Player"),this.selfPlayer.isSelf=!0,this.gameInit(),this.startGamePrepare()},update:function(e){this.elapsedTime+=e,this.waterBubble.node.y=this.waterNode.y+this.getWaterHeight()-500,s.instance.gameStarted&&this.stonesNode.childrenCount<=20&&this.createNewSceneObjs()},touchStartCallback:function(){s.instance.gameStarted&&o.instance.selfPlayer.tryHoldStone()},touchEndCallback:function(){},onReadyGoCompleted:function(){this.startGame()},onPerfectAnimCompleted:function(e){this.perfectEffectPool.put(e)},strLen:function(e){for(var t=0,n=0;n<e.length;n++)e.charCodeAt(n)>256?t+=2:t++;return t},getTrimStr:function(e){if(this.strLen(e)<=10)return e;for(var t=0,n=0;n<e.length;n++)if(e.charCodeAt(n)>256?t+=2:t++,t>=10)return e.substr(0,n+1)+"..."},playerRelive:function(){this.resultPanel.hide(),this.selfPlayer.restart();var e=o.instance.levelStones[this.selfPlayer.holdStoneId].ypos-700;this.setWaterHeight(e)},gameReset:function(){s.instance.gameStarted=!1,this.playNewRecordEffect(!1),this.areaStartYPos=-s.instance.screenHalfHeight,this.elapsedTime=0,this.levelStones=[],this.stoneIndex=0,this.stoneStartIndex=0,this.lastTrunkStoneIndex=0,this.stripeLastYPos=0,this.stoneMinX=0,this.stoneMinY=0,this.stoneMaxX=0,this.stoneMaxY=0,this.branchStoneOdds=0,this.selfPlayerNode.parent.active=!1,this.water.reset(),this.water2.reset(),this.waterBubble.resetSystem(),this.gameInit()},gameInit:function(){for(var e=[],t=0;t<this.stonesNode.childrenCount;t++)e.push(this.stonesNode.children[t]);for(var i=0;i<e.length;i++)"stone_crack"===e[i].name?this.crackStoneObjPool.put(e[i]):this.stoneObjPool.put(e[i]);this.stonesNode.removeAllChildren(),e=[];for(var a=0;a<this.marksNode.childrenCount;a++)e.push(this.marksNode.children[a]);for(var o=0;o<e.length;o++)this.markObjPool.put(e[o]);this.marksNode.removeAllChildren(),e=[];for(var r=0;r<this.stripesNode.childrenCount;r++)e.push(this.stripesNode.children[r]);for(var c=0;c<e.length;c++)this.stripeObjPool.put(e[c]);this.stripesNode.removeAllChildren(),e=[];for(var l=0;l<this.spotsNode.childrenCount;l++)e.push(this.spotsNode.children[l]);for(var d=0;d<e.length;d++)this.spotObjPool.put(e[d]);this.spotsNode.removeAllChildren(),e=[];for(var h=0;h<this.totemsNode.childrenCount;h++)e.push(this.totemsNode.children[h]);for(var u=0;u<e.length;u++)this.totemObjPool.put(e[u]);this.totemsNode.removeAllChildren(),e=[];for(var p=0;p<this.plantsNode.childrenCount;p++)e.push(this.plantsNode.children[p]);for(var f=0;f<e.length;f++)this.plantObjPool.put(e[f]);this.plantsNode.removeAllChildren(),e=[];for(var g=0;g<this.crackEffectNode.childrenCount;g++)e.push(this.crackEffectNode.children[g]);for(var m=0;m<e.length;m++)this.crackEffectPool.put(e[m]);this.crackEffectNode.removeAllChildren(),this.stonesNode.parent.setPosition(0,0),this.stripeLastYPos=n.default.randRangeNumber(200,500);var v=n.default.randRangeNumber(0,3),S=n.default.randRangeNumber(0,359),y=this.stoneScaleParams[n.default.randRangeNumber(0,this.stoneScaleParams.length-1)];this.levelStones.push({id:this.stoneIndex++,typeId:v,xpos:330,ypos:s.instance.screenHalfHeight,rotate:S,scale:y,perfected:!1}),this.levelInit(),this.createNewSceneObjs()},startGamePrepare:function(){this.readyGoAnim.play(),a.instance.playReadyGo(),this.selfPlayerNode.parent.active=!0,this.selfPlayer.reset(),this.TTGAME&&s.instance.recorder.start()},startGame:function(){this.selfPlayer.setState("start"),a.instance.playBgMusic(!0),this.startRecycleSchedule(),s.instance.gameStarted=!0},startRecycleSchedule:function(){this.schedule(this.objRecycle,5,cc.macro.REPEAT_FOREVER,5)},objRecycle:function(){for(var e=[],t=0;t<this.stonesNode.childrenCount&&Math.abs(this.stonesNode.parent.y)-this.stonesNode.children[t].y>s.instance.screenHalfHeight+75;t++)e.push(this.stonesNode.children[t]);for(var n=0;n<e.length;n++)"stone_crack"===e[n].name?this.crackStoneObjPool.put(e[n]):this.stoneObjPool.put(e[n]);e=[];for(var i=0;i<this.stripesNode.childrenCount&&Math.abs(this.stonesNode.parent.y)-this.stripesNode.children[i].y>s.instance.screenHalfHeight+75;i++)e.push(this.stripesNode.children[i]);for(var a=0;a<e.length;a++)this.stripeObjPool.put(e[a]);e=[];for(var o=0;o<this.marksNode.childrenCount&&Math.abs(this.stonesNode.parent.y)-this.marksNode.children[o].y>s.instance.screenHalfHeight+75;o++)e.push(this.marksNode.children[o]);for(var r=0;r<e.length;r++)this.markObjPool.put(e[r]);e=[];for(var c=0;c<this.spotsNode.childrenCount&&Math.abs(this.stonesNode.parent.y)-this.spotsNode.children[c].y>s.instance.screenHalfHeight+75;c++)e.push(this.spotsNode.children[c]);for(var l=0;l<e.length;l++)this.spotObjPool.put(e[l]);e=[];for(var d=0;d<this.totemsNode.childrenCount&&Math.abs(this.stonesNode.parent.y)-this.totemsNode.children[d].y>s.instance.screenHalfHeight+75;d++)e.push(this.totemsNode.children[d]);for(var h=0;h<e.length;h++)this.totemObjPool.put(e[h]);e=[];for(var u=0;u<this.plantsNode.childrenCount&&Math.abs(this.stonesNode.parent.y)-this.plantsNode.children[u].y>s.instance.screenHalfHeight+75;u++)e.push(this.plantsNode.children[u]);for(var p=0;p<e.length;p++)this.plantObjPool.put(e[p]);e=[];for(var f=0;f<this.crackEffectNode.childrenCount&&Math.abs(this.stonesNode.parent.y)-this.crackEffectNode.children[f].y>s.instance.screenHalfHeight+75;f++)e.push(this.crackEffectNode.children[f]);for(var g=0;g<e.length;g++)this.crackEffectPool.put(e[g])},levelInit:function(){for(var e=0,t=0,i=0,a=0,s=0,o=0,r=0;r<10;r++){var c=n.default.randRangeNumber(0,1);if(0===c)for(var l=0;l<8;l++)a=(Math.random()<.3?n.default.randRangeNumber(5,15):n.default.randRangeNumber(-15,-5))*this.a2r,s=this.levelStones[this.lastTrunkStoneIndex].xpos,o=this.levelStones[this.lastTrunkStoneIndex].ypos,s+=this.rotateRadius*Math.sin(a),o+=this.rotateRadius*Math.cos(a),e=n.default.randRangeNumber(0,3),this.lastTrunkStoneIndex=this.stoneIndex,t=n.default.randRangeNumber(0,359),i=this.stoneScaleParams[n.default.randRangeNumber(0,this.stoneScaleParams.length-1)],this.levelStones.push({id:this.stoneIndex++,typeId:e,xpos:s,ypos:o,rotate:t,scale:i,perfected:!1,node:null,trunk:!0}),Math.random()<.3&&this.lastTrunkStoneIndex>5&&(a=(Math.random()<.5?n.default.randRangeNumber(-85,-60):n.default.randRangeNumber(60,85))*this.a2r,s=this.levelStones[this.lastTrunkStoneIndex].xpos,o=this.levelStones[this.lastTrunkStoneIndex].ypos,n.default.randRangeNumber(0,100)>40?(Math.random()<.5?(s+=(this.rotateRadius-60)*Math.sin(a),o+=(this.rotateRadius-60)*Math.cos(a)):(s+=(this.rotateRadius+60)*Math.sin(a),o+=(this.rotateRadius+60)*Math.cos(a)),e=n.default.randRangeNumber(0,3),t=n.default.randRangeNumber(0,359)):(s+=this.rotateRadius*Math.sin(a),o+=this.rotateRadius*Math.cos(a),e=this.stonePrefabs.length,t=0),i=this.stoneScaleParams[n.default.randRangeNumber(0,this.stoneScaleParams.length-1)],this.levelStones.push({id:this.stoneIndex++,typeId:e,xpos:s,ypos:o,rotate:t,scale:i,perfected:!1,node:null,trunk:!1}));else if(1===c)for(var d=0;d<8;d++)a=(Math.random()<.5?n.default.randRangeNumber(16,45):n.default.randRangeNumber(-45,-16))*this.a2r,s=this.levelStones[this.lastTrunkStoneIndex].xpos,o=this.levelStones[this.lastTrunkStoneIndex].ypos,s+=this.rotateRadius*Math.sin(a),o+=this.rotateRadius*Math.cos(a),e=n.default.randRangeNumber(0,3),this.lastTrunkStoneIndex=this.stoneIndex,t=n.default.randRangeNumber(0,359),i=this.stoneScaleParams[n.default.randRangeNumber(0,this.stoneScaleParams.length-1)],this.levelStones.push({id:this.stoneIndex++,typeId:e,xpos:s,ypos:o,rotate:t,scale:i,perfected:!1,node:null,trunk:!0}),Math.random()<.3&&this.lastTrunkStoneIndex>5&&(a=(Math.random()<.5?n.default.randRangeNumber(-85,-65):n.default.randRangeNumber(65,85))*this.a2r,s=this.levelStones[this.lastTrunkStoneIndex].xpos,o=this.levelStones[this.lastTrunkStoneIndex].ypos,n.default.randRangeNumber(0,100)>40?(Math.random()<.5?(s+=(this.rotateRadius-60)*Math.sin(a),o+=(this.rotateRadius-60)*Math.cos(a)):(s+=(this.rotateRadius+60)*Math.sin(a),o+=(this.rotateRadius+60)*Math.cos(a)),e=n.default.randRangeNumber(0,3),t=n.default.randRangeNumber(0,359)):(s+=this.rotateRadius*Math.sin(a),o+=this.rotateRadius*Math.cos(a),e=this.stonePrefabs.length,t=0),i=this.stoneScaleParams[n.default.randRangeNumber(0,this.stoneScaleParams.length-1)],this.levelStones.push({id:this.stoneIndex++,typeId:e,xpos:s,ypos:o,rotate:t,scale:i,perfected:!1,node:null,trunk:!1}))}console.log("############# Total Stone Num="+this.levelStones.length)},updateLevelRect:function(e,t){e<this.stoneMinX&&(this.stoneMinX=e),e>this.stoneMaxX&&(this.stoneMaxX=e),t<this.stoneMinY&&(this.stoneMinY=t),t>this.stoneMaxY&&(this.stoneMaxY=t)},createNewSceneObjs:function(){this.stoneMinX=this.levelStones[this.stoneStartIndex].xpos,this.stoneMinY=this.levelStones[this.stoneStartIndex].ypos,this.stoneMaxX=this.stoneMinX,this.stoneMaxY=this.stoneMinY,console.log("createNewScene stoneStartIdx="+this.stoneStartIndex),this.stoneStartIndex+30>=this.levelStones.length-20&&this.levelInit();for(var e=null,t=this.stoneStartIndex;t<this.stoneStartIndex+30;t++)this.levelStones[t].typeId===this.stonePrefabs.length?e=this.crackStoneObjPool.get():(null===(e=this.stoneObjPool.get())&&console.error("stone is null get from objpool size="+this.stoneObjPool.size()),e.getComponent(cc.Sprite).spriteFrame=this.stoneSprites[this.levelStones[t].typeId].spriteFrame),this.stonesNode.addChild(e),e.setPosition(cc.v2(this.levelStones[t].xpos-s.instance.screenHalfWidth,this.levelStones[t].ypos-s.instance.screenHalfHeight)),e.rotation=this.levelStones[t].rotate,e.setScale(this.levelStones[t].scale,this.levelStones[t].scale),this.updateLevelRect(this.levelStones[t].xpos,this.levelStones[t].ypos),this.levelStones[t].node=e;this.stoneStartIndex+=30,console.log("########## Min("+this.stoneMinX+","+this.stoneMinY+")   Max("+this.stoneMaxX+","+this.stoneMaxY+")");for(var i=Math.floor(this.stoneMinX/s.instance.screenSize.width)-1,a=Math.floor(this.stoneMaxX/s.instance.screenSize.width)+1,o=[],r=0;r<50&&(Math.random()<.5?(o.push({ypos:this.stripeLastYPos,typeId:n.default.randRangeNumber(0,1)}),this.stripeLastYPos+=n.default.randRangeNumber(100,120),o.push({ypos:this.stripeLastYPos,typeId:n.default.randRangeNumber(2,4)}),this.stripeLastYPos+=n.default.randRangeNumber(750,1100)):(o.push({ypos:this.stripeLastYPos,typeId:n.default.randRangeNumber(1,3)}),this.stripeLastYPos+=n.default.randRangeNumber(90,120),o.push({ypos:this.stripeLastYPos,typeId:n.default.randRangeNumber(2,3)}),this.stripeLastYPos+=n.default.randRangeNumber(100,150),o.push({ypos:this.stripeLastYPos,typeId:n.default.randRangeNumber(3,4)}),this.stripeLastYPos+=n.default.randRangeNumber(850,1100)),!(this.stripeLastYPos>this.stoneMaxY));r++);console.log("stripeDataLen="+o.length+" stripeLastY="+this.stripeLastYPos+" poolsize="+this.stripeObjPool.size());for(var c=0;c<o.length;c++)for(var l=i;l<=a;l++){var d=this.stripeObjPool.get();d.getComponent(cc.Sprite).spriteFrame=this.stripeSprites[o[c].typeId].spriteFrame,this.stripesNode.addChild(d),d.setPosition(cc.v2(s.instance.designResolutionWidth*l,o[c].ypos-s.instance.screenHalfHeight))}console.log("stripe childrenCount="+this.stripesNode.childrenCount);var h=i*s.instance.screenSize.width-s.instance.screenHalfWidth,u=a*s.instance.screenSize.width+s.instance.screenHalfWidth,p=this.areaStartYPos,f=this.stoneMaxY;this.areaStartYPos=f;for(var g=0;g<25;g++){var m=this.markObjPool.get();m.getComponent(cc.Sprite).spriteFrame=this.markSprites[n.default.randRangeNumber(0,1)].spriteFrame,this.marksNode.addChild(m),m.setPosition(cc.v2(n.default.randRangeNumber(h,u),n.default.randRangeNumber(p,f)))}for(var v=0;v<70;v++){var S=this.spotObjPool.get();S.getComponent(cc.Sprite).spriteFrame=this.spotSprites[n.default.randRangeNumber(0,2)].spriteFrame,this.spotsNode.addChild(S),S.setPosition(cc.v2(n.default.randRangeNumber(h,u),n.default.randRangeNumber(p,f)))}for(var y=0;y<20;y++){var P=this.totemObjPool.get();P.getComponent(cc.Sprite).spriteFrame=this.totemSprites[n.default.randRangeNumber(0,3)].spriteFrame,this.totemsNode.addChild(P),P.setPosition(cc.v2(n.default.randRangeNumber(h,u),n.default.randRangeNumber(p,f)))}for(var b=0;b<45;b++){var N,w=this.plantObjPool.get(),C=n.default.randRangeNumber(0,100);N=C>=0&&C<70?0:C>=70&&C<90?1:2,w.getComponent(cc.Sprite).spriteFrame=this.plantSprites[N].spriteFrame,this.plantsNode.addChild(w),w.setPosition(cc.v2(n.default.randRangeNumber(h,u),n.default.randRangeNumber(p,f))),w.rotation=n.default.randRangeNumber(-30,30);var A=.01*n.default.randRangeNumber(60,100);w.setScale(A,A)}},playNewRecordEffect:function(e){var t=this;e?(this.newRecordEffects[0].resetSystem(),this.scheduleOnce(function(){!0===o.instance.resultPanelNode.active&&t.newRecordEffects[1].resetSystem()},.3),this.scheduleOnce(function(){!0===o.instance.resultPanelNode.active&&t.newRecordEffects[2].resetSystem()},.6)):(this.newRecordEffects[0].stopSystem(),this.newRecordEffects[1].stopSystem(),this.newRecordEffects[2].stopSystem())},gameOver:function(){var e=this;s.instance.gameStarted=!1,a.instance.playBgMusic(!1),s.instance.TTGAME&&s.instance.recorder.stop(),this.scheduleOnce(function(){var t=o.instance.selfPlayer.holdStoneId;e.resultPanel.show(t),t>=6&&s.instance.DelayShowInterstitial()},.8)}});cc._RF.pop()},{"./AppMain":"AppMain","./Audio":"Audio","./DataStorage":"DataStorage","./GameDef":"GameDef","./Platform":"Platform","./Stone":"Stone","./Util":"Util","./VideoRecord":"VideoRecord"}],GoldAmount:[function(e,t){"use strict";cc._RF.push(t,"1c21aOlx2RK1YzLDUEyhlw0","GoldAmount");var n=e("./Game");cc.Class({extends:cc.Component,properties:{},start:function(){},updateGold:function(){this.node.getChildByName("goldLabel").getComponent(cc.Label).string=""+n.instance.gold}}),cc._RF.pop()},{"./Game":"Game"}],LogoAnimCallback:[function(e,t){"use strict";cc._RF.push(t,"957e3ZKCfRPjZ3IWqmQJyKx","LogoAnimCallback"),cc.Class({extends:cc.Component,properties:{smokeEffect:{default:null,type:cc.ParticleSystem}},onAnimCompleted:function(){this.smokeEffect.resetSystem()}}),cc._RF.pop()},{}],MainMenu:[function(e,t){"use strict";cc._RF.push(t,"a7824QDs2FB8IqwrD6mnwLm","MainMenu");var n=e("./GameDef"),i=e("./AppMain"),a=e("./Audio");cc.Class({extends:cc.Component,properties:{logo:{default:null,type:cc.Node},endlessModeBtn:{default:null,type:cc.Node},rankBtn:{default:null,type:cc.Node},signBtn:{default:null,type:cc.Node},sndBtn:{default:null,type:cc.Node},dailyAwardNode:{default:null,type:cc.Node},rankNode:{default:null,type:cc.Node},sndSprites:{default:[],type:[cc.SpriteFrame]},coinLabel:{default:null,type:cc.Label}},statics:{instance:null},onLoad:function(){this.instance=this,this.dailyAwardPage=this.dailyAwardNode.getComponent("DailyAwardPage"),this.rankPage=this.rankNode.getComponent("RankPanel")},onDestroy:function(){this.instance=null},start:function(){this.updateSndBtnDisplay(),this.updateCoinLabel(),i.instance.dailyAwardChecked?this.showMainMenu(!0):(i.instance.dailyAwardChecked=!0,this.dailyAwardPage.showDailyAwardPanel())},onEnable:function(){this.updateSndBtnDisplay()},updateCoinLabel:function(){console.log("updateCoinLabel"),this.coinLabel.string=""+i.instance.coin},showMainMenu:function(e){var t=this;if(e){var a=i.instance.gameState;this.scheduleOnce(function(){a===n.GameState.MainMenu&&(t.logo.active=!0,t.logo.getComponent(cc.Animation).play())},.1),this.scheduleOnce(function(){a===n.GameState.MainMenu&&(t.endlessModeBtn.active=!0,t.endlessModeBtn.getComponent(cc.Animation).play())},.25),this.scheduleOnce(function(){a===n.GameState.MainMenu&&(t.rankBtn.active=!1)},.35),this.scheduleOnce(function(){a===n.GameState.MainMenu&&(t.signBtn.active=!0,t.signBtn.getComponent(cc.Animation).play())},.45),this.scheduleOnce(function(){a===n.GameState.MainMenu&&(t.sndBtn.active=!0,t.sndBtn.getComponent(cc.Animation).play())},.55)}else this.logo.active=!1,this.endlessModeBtn.active=!1,this.rankBtn.active=!1,this.signBtn.active=!1,this.sndBtn.active=!1},showMainMenuDirectly:function(){this.logo.active=!0,this.endlessModeBtn.active=!0,this.rankBtn.active=!1,this.signBtn.active=!0,this.sndBtn.active=!0},onEndlessBtnClicked:function(){var e=this;cc.director.loadScene("game",function(){i.instance.hideBannerAd(),e.gameState=n.GameState.GameEndless})},onRankBtnClicked:function(){this.showMainMenu(!1),this.rankPage.show()},onDailyAwardBtnClicked:function(){this.showMainMenu(!1),this.dailyAwardPage.showDailyAwardPanel(!0)},updateSndBtnDisplay:function(){var e=this.sndBtn.getComponent(cc.Sprite);"on"===a.instance.sndOn?e.spriteFrame=this.sndSprites[0]:e.spriteFrame=this.sndSprites[1]},onSndBtnClicked:function(){"on"===a.instance.sndOn?a.instance.sndOn="off":a.instance.sndOn="on",this.updateSndBtnDisplay(),i.instance.saveDataStorage()},update:function(){}}),cc._RF.pop()},{"./AppMain":"AppMain","./Audio":"Audio","./GameDef":"GameDef"}],Platform:[function(e,t,n){"use strict";cc._RF.push(t,"7f4b84diCNI+pSLVc3YH00K","Platform"),n.__esModule=!0,n.default=void 0;var i=e("./DataStorage"),a=function(){function e(){this.uidFileName="uid.dat",this.uid=""}var t=e.prototype;return t.genUUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)})},t.uidCheck=function(){if(i.dataExist("uid")){var e=i.load("uid");this.uid=e.uid}else this.uid=this.genUUID(),i.save("uid",{uid:this.uid})},t.uidCheckInFile=function(){var e=wx.getFileSystemManager();try{e.accessSync(this.uidFileName);var t=e.readFileSync(this.uidFileName,"utf8");this.uid=JSON.parse(t).uid}catch(i){console.log("err="+i.toString()),this.uid=this.genUUID(),console.log("uid="+this.uid);var n={uid:this.uid};e.writeFileSync(this.uidFileName,JSON.stringify(n),"utf8")}},e}();n.default=a,t.exports=n.default,cc._RF.pop()},{"./DataStorage":"DataStorage"}],Player:[function(e,t){"use strict";var n;cc._RF.push(t,"d6b9bfg5VNFnJ+pTsXfEbo3","Player"),(n=e("./Util"))&&n.__esModule;var i=e("./AppMain"),a=e("./Game"),s=e("./Audio");cc.Class({extends:cc.Component,properties:{rotateSpeed:{default:175,visible:!1},lHandWorldPos:{visible:!1,type:cc.Vec2,get:function(){if(this.lHandBone){var e=cc.v2(this.lHandBone.global.x,-this.lHandBone.global.y);return this.armature.display.convertToWorldSpace(e)}}},rHandWorldPos:{visible:!1,type:cc.Vec2,get:function(){if(this.rHandBone){var e=cc.v2(this.rHandBone.global.x,-this.rHandBone.global.y);return this.armature.display.convertToWorldSpace(e)}}},centerWorldPos:{visible:!1,type:cc.Vec2,get:function(){if(this.rHandBone){var e=cc.v2(this.rHandBone.global.x,-this.rHandBone.global.y);return this.armature.display.convertToWorldSpace(e)}}},bubbleEffect:{default:null,type:cc.ParticleSystem},isSelf:{default:!0,visible:!1},playerData:{default:null,type:Object,visible:!1},roleId:{default:1,visible:!1}},reset:function(){this.rotateSpeed=175,this.armatureDisplay.playAnimation("idle",0),this.state="idle",this.holdState="lhand",this.holdStoneId=0,this.holdStoneCount=0,this.bubbleEffect.stopSystem(),this.holdStartRotation=0,this.aiHoldFirstCircle=!1,this.joint.rotation=0,this.node.rotation=0,this.joint.setPosition(a.instance.levelStones[0].xpos-i.instance.screenHalfWidth,a.instance.levelStones[0].ypos-i.instance.screenHalfHeight),this.node.setPosition(this.lh_pos),this.shadowDisplay&&(this.shadowDisplay.node.setPosition(this.lh_shadow_pos),this.shadowDisplay.node.rotation=0,this.shadowDisplay.playAnimation("idle",0))},onLoad:function(){if(this.state="idle",this.holdState="lhand",this.holdStoneId=0,this.holdStoneCount=0,this.joint=this.node.parent,this.roleNode=this.node.getChildByName("role"),this.armatureDisplay=this.roleNode.getComponent(dragonBones.ArmatureDisplay),this.armature=this.armatureDisplay.armature(),"selfPlayer"===this.node.name){var e=this.node.parent.getChildByName("shadow");this.shadowDisplay=e.getComponent(dragonBones.ArmatureDisplay)}else this.shadowDisplay=null;this.holdStartRotation=0,this.fallThreshold=720,this.xv=0,this.yv=0,this.rv=0,this.lh_pos=cc.v2(125,-60),this.lh_shadow_pos=cc.v2(135,-80),this.rh_pos=cc.v2(-125,-60),this.rh_shadow_pos=cc.v2(-115,-80),this.fallXAcce=40,this.fallYAcce=3750,this.fallRotateAcce=240,this.aiHoldFirstCircle=!1,this.lHandBone=this.armature.getBone("IK_ArmL"),this.rHandBone=this.armature.getBone("IK_ArmR"),this.centerNode=this.node.getChildByName("center"),this.armatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,this.animEventHandler,this),this.resurgenceTime=new Date},animEventHandler:function(e){e.type===dragonBones.EventObject.COMPLETE&&"start"===e.animationState.name&&(this.holdState="lhand_rotate")},start:function(){},restart:function(){this.bubbleEffect.stopSystem(),this.setState("start"),this.joint.rotation=0,this.node.rotation=0,this.shadowDisplay&&(this.shadowDisplay.node.rotation=0),this.holdStartRotation=0,this.joint.setPosition(a.instance.levelStones[this.holdStoneId].xpos-i.instance.screenHalfWidth,a.instance.levelStones[this.holdStoneId].ypos-i.instance.screenHalfHeight),this.node.setPosition(this.lh_pos),this.shadowDisplay&&this.shadowDisplay.node.setPosition(this.lh_shadow_pos)},update:function(e){if("fall_l"===this.holdState?this.fallUpdate(e):"fall_r"===this.holdState&&this.fallUpdate(e),!1!==i.instance.gameStarted){"lhand_rotate"===this.holdState?(i.instance.firstPlay&&0===this.holdStoneId&&this.rHandWorldPos.sub(cc.v2(a.instance.levelStones[1].xpos+a.instance.stonesNode.parent.x,a.instance.levelStones[1].ypos+a.instance.stonesNode.parent.y)).mag()<35&&!1===a.instance.guideText1.active&&(a.instance.guideText1.active=!0,a.instance.guideTapAnim.node.active=!0,a.instance.guideTapAnim.play(),a.instance.disGuidePointer(),this.rotateSpeed=0,a.instance.water.riseSpeed=0,a.instance.water2.riseSpeed=0),this.joint.rotation-=this.rotateSpeed*e,a.instance.getWaterHeight()>a.instance.levelStones[this.holdStoneId].ypos+135&&(a.instance.gameOver(),this.fallLeft(),s.instance.playInWater(),this.bubbleEffect.resetSystem())):"rhand_rotate"===this.holdState&&(i.instance.firstPlay&&1===this.holdStoneId&&this.lHandWorldPos.sub(cc.v2(a.instance.levelStones[2].xpos+a.instance.stonesNode.parent.x,a.instance.levelStones[2].ypos+a.instance.stonesNode.parent.y)).mag()<10&&!1===a.instance.guideText2.active&&(a.instance.guideText2.active=!0,a.instance.guideTapAnim.node.active=!0,a.instance.guideTapAnim.play(),a.instance.disGuidePointer(),this.rotateSpeed=0,a.instance.water.riseSpeed=0,a.instance.water2.riseSpeed=0),this.joint.rotation+=this.rotateSpeed*e,this.updateGameArgs(),a.instance.getWaterHeight()>a.instance.levelStones[this.holdStoneId].ypos+135&&(a.instance.gameOver(),this.fallRight(),s.instance.playInWater(),this.bubbleEffect.resetSystem()));var t=this.node.parent.convertToWorldSpace(this.node.getPosition());t.x+=10,t.y-=20;var n=this.node.parent.convertToNodeSpace(cc.v2(t.x,t.y));this.shadowDisplay.node.setPosition(n)}},fallUpdate:function(e){var t=this.joint.getPosition(),n=this.centerNode.getPosition(),i=this.node.convertToWorldSpace(cc.v2(n.x,n.y)),o=a.instance.getWaterHeight()+a.instance.stonesNode.parent.getPosition().y,r=!1;i.y<o&&(r=!0),r?this.joint.setPosition(t.x+40*e,t.y-155*e):this.joint.setPosition(t.x+this.xv*e,t.y+this.yv*e),this.xv<0?(this.xv+=this.fallXAcce*e,this.xv>0&&(this.xv=0)):this.xv>0&&(this.xv-=this.fallXAcce*e,this.xv<0&&(this.xv=0)),this.yv-=this.fallYAcce*e,r?this.rv>0?this.node.rotation+=45*e:this.node.rotation-=45*e:this.node.rotation+=this.rv*e,this.shadowDisplay&&(this.shadowDisplay.node.rotation=this.node.rotation),"fall_l"===this.holdState?this.rv-=this.fallRotateAcce*e:this.rv+=this.fallRotateAcce*e;var c=this.node.convertToWorldSpace(cc.v2(n.x,n.y));i.y>=o&&c.y<=o&&(a.instance.playSplashEffect(c),s.instance.playFallWater(),this.bubbleEffect.resetSystem())},setState:function(e){"start"===e?(this.armatureDisplay.playAnimation("start",1),this.shadowDisplay&&this.shadowDisplay.playAnimation("start",1),this.state="start",this.holdState="lhand"):"hold_R"===e?(this.armatureDisplay.playAnimation("hold_R",1),this.shadowDisplay&&this.shadowDisplay.playAnimation("hold_R",1),this.state="hold_R",this.holdState="rhand_rotate"):"hold_L"===e&&(this.armatureDisplay.playAnimation("hold_L",1),this.shadowDisplay&&this.shadowDisplay.playAnimation("hold_L",1),this.state="hold_L",this.holdState="lhand_rotate")},fallLeft:function(){this.armatureDisplay.playAnimation("hold_R",1),this.shadowDisplay&&this.shadowDisplay.playAnimation("hold_R",1),this.holdState="fall_l";var e=this.joint.rotation%360;e<-170&&e>-350?(this.xv=300,this.yv=0):(this.xv=-300,this.yv=150),this.rv=-45},fallRight:function(){this.armatureDisplay.playAnimation("hold_L",1),this.shadowDisplay&&this.shadowDisplay.playAnimation("hold_L",1),this.holdState="fall_r";var e=360-Math.abs(this.joint.rotation%360);e>10&&e<190?(this.xv=300,this.yv=150):(this.xv=-300,this.yv=0),this.rv=45},updateGameArgs:function(){this.holdStoneCount>5&&this.holdStoneCount<=20?(this.rotateSpeed=180,a.instance.branchStoneOdds=.15,a.instance.water.riseSpeed=160,a.instance.water2.riseSpeed=160):this.holdStoneCount>20&&this.holdStoneCount<=50?(this.rotateSpeed=180,a.instance.branchStoneOdds=.25,a.instance.water.riseSpeed=180,a.instance.water2.riseSpeed=180):this.holdStoneCount>50&&this.holdStoneCount<=100?(this.rotateSpeed=190,a.instance.branchStoneOdds=.3,a.instance.water.riseSpeed=230,a.instance.water2.riseSpeed=230):this.holdStoneCount>100&&this.holdStoneCount<=150?(this.rotateSpeed=190,a.instance.branchStoneOdds=.3,a.instance.water.riseSpeed=260,a.instance.water2.riseSpeed=260):this.holdStoneCount>150&&this.holdStoneCount<=250?(this.rotateSpeed=200,a.instance.branchStoneOdds=.35,a.instance.water.riseSpeed=300,a.instance.water2.riseSpeed=300):this.holdStoneCount>250&&(this.rotateSpeed=200,a.instance.branchStoneOdds=.35,a.instance.water.riseSpeed=350,a.instance.water2.riseSpeed=350)},getNearestStone:function(e){var t=e?this.lHandWorldPos:this.rHandWorldPos,n=this.holdStoneId-4;n<0&&(n=0);var i=this.holdStoneId+4;i>a.instance.levelStones.length-1&&(i=a.instance.levelStones.length-1);for(var s=n,o=0,r=n;r<=i;r++){var c=t.sub(cc.v2(a.instance.levelStones[r].xpos+a.instance.stonesNode.parent.x,a.instance.levelStones[r].ypos+a.instance.stonesNode.parent.y)).mag();r==n?o=c:c<o&&(s=r,o=c)}var l={};return l.id=s,o.dis=o,l},tryHoldStone:function(){if("lhand_rotate"===this.holdState||"rhand_rotate"===this.holdState)if("lhand_rotate"===this.holdState){var e=this.rHandWorldPos,t=this.holdStoneId-4;t<0&&(t=0);var n=this.holdStoneId+4;n>a.instance.levelStones.length-1&&(n=a.instance.levelStones.length-1);for(var o=t;o<=n;o++){var r=e.sub(cc.v2(a.instance.levelStones[o].xpos+a.instance.stonesNode.parent.x,a.instance.levelStones[o].ypos+a.instance.stonesNode.parent.y)).mag();if(r<=150+55*a.instance.levelStones[o].scale){if(a.instance.levelStones[o].typeId===a.instance.stonePrefabs.length){var c=a.instance.levelStones[o].node;return null!==c&&c.getComponent(cc.Animation).play(),a.instance.gameOver(),this.fallLeft(),void(this.isSelf&&(s.instance.playFall(),s.instance.playHoldFail()))}this.setState("hold_R");var l=this.holdStoneId;this.holdStoneId=o,this.holdStoneCount++,this.joint.x=a.instance.levelStones[o].xpos-i.instance.screenHalfWidth,this.joint.y=a.instance.levelStones[o].ypos-i.instance.screenHalfHeight,this.node.setPosition(this.rh_pos),this.shadowDisplay&&this.shadowDisplay.node.setPosition(this.rh_shadow_pos),this.holdStoneId>l&&(a.instance.scoreLabel.string="-"+this.holdStoneId+"-"),r<=a.instance.perfectHoldDis&&a.instance.perfectHold(),a.instance.stonesNode.parent.getPosition();var d=330-a.instance.levelStones[o].xpos,h=i.instance.screenHalfHeight-a.instance.levelStones[o].ypos,u=cc.moveTo(.3,cc.v2(d,h));return a.instance.stonesNode.parent.runAction(u),this.holdStartRotation=this.joint.rotation,this.isSelf&&s.instance.playHold(),this.updateGameArgs(),0===l&&!0===a.instance.guideText1.active&&(a.instance.guideText1.active=!1,a.instance.guideTapAnim.node.active=!1,a.instance.guidePointerAnim.node.active=!1,this.rotateSpeed=175,a.instance.water.riseSpeed=150,a.instance.water2.riseSpeed=150),void(i.instance.firstPlay&&this.holdStoneId>4&&i.instance.setFirstPlay(!1))}}a.instance.gameOver(),this.fallLeft(),this.isSelf&&(s.instance.playFall(),s.instance.playHoldFail())}else if("rhand_rotate"===this.holdState){var p=this.lHandWorldPos,f=this.holdStoneId-4;f<0&&(f=0);var g=this.holdStoneId+4;g>a.instance.levelStones.length-1&&(g=a.instance.levelStones.length-1);for(var m=f;m<=g;m++){var v=p.sub(cc.v2(a.instance.levelStones[m].xpos+a.instance.stonesNode.parent.x,a.instance.levelStones[m].ypos+a.instance.stonesNode.parent.y)).mag();if(v<=150+55*a.instance.levelStones[m].scale){if(a.instance.levelStones[m].typeId===a.instance.stonePrefabs.length){var S=a.instance.levelStones[m].node;return null!==S&&S.getComponent(cc.Animation).play(),a.instance.gameOver(),this.fallRight(),void(this.isSelf&&(s.instance.playFall(),s.instance.playHoldFail()))}console.log("\u6293\u53d6\u8ddd\u79bb="+v),this.setState("hold_L");var y=this.holdStoneId;this.holdStoneId=m,this.holdStoneCount++,this.joint.x=a.instance.levelStones[m].xpos-i.instance.screenHalfWidth,this.joint.y=a.instance.levelStones[m].ypos-i.instance.screenHalfHeight,this.node.setPosition(this.lh_pos),this.shadowDisplay&&this.shadowDisplay.node.setPosition(this.lh_shadow_pos),this.holdStoneId>y&&(a.instance.scoreLabel.string="-"+this.holdStoneId+"-"),v<=a.instance.perfectHoldDis&&a.instance.perfectHold(),a.instance.stonesNode.parent.getPosition();var P=330-a.instance.levelStones[m].xpos,b=i.instance.screenHalfHeight-a.instance.levelStones[m].ypos,N=cc.moveTo(.3,cc.v2(P,b));return a.instance.stonesNode.parent.runAction(N),this.holdStartRotation=this.joint.rotation,this.isSelf&&s.instance.playHold(),this.updateGameArgs(),!0===a.instance.guideText2.active&&(a.instance.guideText2.active=!1,a.instance.guideTapAnim.node.active=!1,a.instance.guidePointerAnim.node.active=!1,this.rotateSpeed=175,a.instance.water.riseSpeed=150,a.instance.water2.riseSpeed=150),void(i.instance.firstPlay&&this.holdStoneId>4&&i.instance.setFirstPlay(!1))}}a.instance.gameOver(),this.fallRight(),this.isSelf&&(s.instance.playFall(),s.instance.playHoldFail())}}}),cc._RF.pop()},{"./AppMain":"AppMain","./Audio":"Audio","./Game":"Game","./Util":"Util"}],PrepareRelive:[function(e,t){"use strict";cc._RF.push(t,"4f1aeLI2e5IX5NRpoZrusr7","PrepareRelive"),e("./GameDef");var n=e("./AppMain"),i=e("./Audio");cc.Class({extends:cc.Component,properties:{countDownLabel:{default:null,type:cc.Label}},onLoad:function(){this.count=3},start:function(){},show:function(){n.instance.hideBannerAd(),this.node.active=!0,this.countDownLabel.node.scale=3,this.countDownLabel.string="3",this.count=3,this.changeCountDown()},changeCountDown:function(){var e=this;if(this.count<=0)return this.hide(),n.instance.gameStarted=!0,void i.instance.playBgMusic(!0);this.countDownLabel.string=""+this.count,this.countDownLabel.node.scale=3;var t=cc.scaleTo(.28,1,1).easing(cc.easeBackOut()),a=cc.sequence(t,cc.callFunc(function(){e.scheduleOnce(function(){e.count--,e.changeCountDown()},.6)}));this.countDownLabel.node.runAction(a)},hide:function(){this.node.active=!1}}),cc._RF.pop()},{"./AppMain":"AppMain","./Audio":"Audio","./GameDef":"GameDef"}],RankItem:[function(e,t){"use strict";cc._RF.push(t,"0b24bH8k3dCbb/fLJ/KGJTw","RankItem"),cc.Class({extends:cc.Component,properties:{rankNumberLabel:{default:null,type:cc.Label},header:{default:null,type:cc.Sprite},nickNameLabel:{default:null,type:cc.Label},scoreLabel:{default:null,type:cc.Label},bgNode:{default:null,type:cc.Node}},onLoad:function(){},start:function(){},setData:function(e,t){var n=this;this.bgNode.active=t%2==0,this.rankNumberLabel.string=""+e.rank,this.rankNumberLabel.node.setScale(1,1),1===e.rank?this.rankNumberLabel.node.color=cc.color(0,0,0,0).fromHEX("#FF8B3B"):2===e.rank?this.rankNumberLabel.node.color=cc.color(0,0,0,0).fromHEX("#F8B551"):3===e.rank?this.rankNumberLabel.node.color=cc.color(0,0,0,0).fromHEX("#FFD493"):(this.rankNumberLabel.node.color=cc.Color.WHITE,this.rankNumberLabel.node.setScale(.9,.9)),e.image_url.length>0&&cc.loader.load({url:e.image_url,type:"png"},function(e,t){e&&console.error(e),n.header.spriteFrame=new cc.SpriteFrame(t)}),this.nickNameLabel.string=e.nick,this.scoreLabel.string=e.points}}),cc._RF.pop()},{}],RankPanel:[function(e,t){"use strict";cc._RF.push(t,"08fc9NYf/ZOo4s+rYGnaHn/","RankPanel");var n=e("./GameDef"),i=e("./AppMain");cc.Class({extends:cc.Component,properties:{itemPrefab:{default:null,type:cc.Prefab},prePageBtn:{default:null,type:cc.Sprite},nextPageBtn:{default:null,type:cc.Sprite},pageBtnSprites:{default:[],type:[cc.SpriteFrame]}},onLoad:function(){this.scrollListView=this.node.getComponent("ScorllListView"),this.pageNum=0,this.pageInFade=!1},show:function(){var e=this;if(!this.pageInFade){this.node.active=!0,this.pageNum=0,this.prePageBtn.node.active=!1,this.nextPageBtn.node.active=!1,this.requestPageContent(this.pageNum),this.pageInFade=!0,this.node.scale=.4,this.node.opacity=0;var t=cc.fadeTo(.3,255);this.node.runAction(t);var n=cc.scaleTo(.3,1,1).easing(cc.easeBackOut()),i=cc.sequence(n,cc.callFunc(function(){e.pageInFade=!1}));this.node.runAction(i)}},hide:function(){var e=this;if(!this.pageInFade){this.pageInFade=!0;var t=cc.scaleTo(.3,.4,.4).easing(cc.easeBackIn()),n=cc.sequence(t,cc.callFunc(function(){e.node.active=!1,e.prePageBtn.node.active=!1,e.nextPageBtn.node.active=!1,e.node.parent.getComponent("MainMenu").showMainMenuDirectly(),e.pageInFade=!1})),i=cc.fadeTo(.3,0);this.node.runAction(n),this.node.runAction(i)}},onPrePageBtnClicked:function(){this.pageNum>0&&(this.pageNum--,this.requestPageContent(this.pageNum))},onNextPageBtnClicked:function(){this.pageNum<9&&(this.pageNum++,this.requestPageContent(this.pageNum))},requestPageContent:function(e){var t=this;if(e>=0&&e<=9){var a={page_num:e},s=cc.loader.getXMLHttpRequest();s.open("POST",n.ApiUrl.GetRankUrl,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.setRequestHeader("Miniuid",i.instance.platform.uid),s.onreadystatechange=function(){if(4===s.readyState&&s.status>=200&&s.status<300){console.log("XML status="+s.status+" res="+s.responseText);var n=JSON.parse(s.responseText);null!==n.data.ranks&&(t.updateItems(n),t.prePageBtn.node.active=!0,t.nextPageBtn.node.active=!0,0===e?(t.prePageBtn.node.getComponent(cc.Button).interactable=!1,t.prePageBtn.spriteFrame=t.pageBtnSprites[0]):(t.prePageBtn.node.getComponent(cc.Button).interactable=!0,t.prePageBtn.spriteFrame=t.pageBtnSprites[2]),e>=9||n.data.ranks.length<11?(t.nextPageBtn.node.getComponent(cc.Button).interactable=!1,t.nextPageBtn.spriteFrame=t.pageBtnSprites[1]):(t.nextPageBtn.node.getComponent(cc.Button).interactable=!0,t.nextPageBtn.spriteFrame=t.pageBtnSprites[3]))}};var o=JSON.stringify(a);s.send(o)}},updateItems:function(e){if(this.scrollListView.clear(),null!==e.data.ranks&&void 0!==e.data.ranks){var t=e.data.ranks.length;t>10&&(t=10);for(var n=0;n<t;n++){var i=cc.instantiate(this.itemPrefab);i.getComponent("RankItem").setData(e.data.ranks[n],n),this.scrollListView.items.push(i)}this.scrollListView.init()}},start:function(){}}),cc._RF.pop()},{"./AppMain":"AppMain","./GameDef":"GameDef"}],ResultPanel:[function(e,t){"use strict";cc._RF.push(t,"28f22LC0EdMPIWQlknfATQT","ResultPanel");var n=e("./GameDef"),i=e("./Game"),a=e("./AppMain");cc.Class({extends:cc.Component,properties:{newRecordNode:{default:null,type:cc.Node},resultScoreLabel:{default:null,type:cc.Label},historyScoreLabel:{default:null,type:cc.Label},reliveCoinBtn:{default:null,type:cc.Node},reliveVideoBtn:{default:null,type:cc.Node},reliveShareBtn:{default:null,type:cc.Node},relivePriceLabel:{default:null,type:cc.Label},prepareReliveNode:{default:null,type:cc.Node},replayBtn:{default:null,type:cc.Node},backBtn:{default:null,type:cc.Node},videoShareBtn:{default:null,type:cc.Node},videoShareBtn2:{default:null,type:cc.Node},coinEffectNode:{default:null,type:cc.Node}},onLoad:function(){this.prepareRelivePanel=this.prepareReliveNode.getComponent("PrepareRelive")},start:function(){},show:function(e){a.instance.showBannerAd(),this.node.active=!0,this.newRecordNode.active=!1,this.reliveCoinBtn.active=!1,this.reliveVideoBtn.active=!1,this.reliveShareBtn.active=!1,this.replayBtn.active=!0,this.backBtn.active=!1,this.videoShareBtn.active=!1,this.videoShareBtn2.active=!1;var t=new Date,s=t.getFullYear(),o=t.getMonth(),r=t.getDate(),c=new Date(a.instance.videoShareDate),l=c.getFullYear(),d=c.getMonth(),h=c.getDate();if(l!==s||d!==o||h!==r?this.videoShareBtn.active=!0:this.videoShareBtn2.active=!0,this.resultScoreLabel.string=""+e,this.historyScoreLabel.string=""+a.instance.bestScore,e>a.instance.bestScore){var u=e-a.instance.bestScore;console.log("point val="+u);var p={points:u};a.instance.xmlHttpRequest(n.ApiUrl.UpdateScoreUrl,p),this.newRecordNode.active=!0,i.instance.playNewRecordEffect(!0),a.instance.bestScore=e,a.instance.saveDataStorage()}if(i.instance.reliveTimes>=2)this.replayBtn.active=!1,this.backBtn.active=!0;else{var f=n.GameConfig.RelivePrice;i.instance.reliveTimes>0&&(f=n.GameConfig.RelivePrice2),a.instance.coin>=f?(this.reliveCoinBtn.active=!0,this.relivePriceLabel.string="x"+f):this.reliveVideoBtn.active=!0}},onReliveCoinBtnClicked:function(){console.log("onReliveCoinBtnClicked");var e=n.GameConfig.RelivePrice;i.instance.reliveTimes>0&&(e=n.GameConfig.RelivePrice2),a.instance.coin>=e&&(a.instance.addCoin(-e),i.instance.updateCoinLabel(),this.prepareRelive())},onReliveVideoBtnClicked:function(){var e=this;a.instance.playVideoAd(function(){e.prepareRelive()})},onVideoShareBtnClicked:function(){var e=this,t=i.instance.coinLabel.node.parent.getChildByName("goldIcon");a.instance.playVideoAd(function(){a.instance.addCoin(n.GameConfig.VideoShareCoinAward,e.coinEffectNode,t),i.instance.updateCoinLabel(),e.videoShareBtn.active=!1})},onVideoShareBtn2Clicked:function(){var e=this;this.TTGAME&&a.instance.recorder.shareClip(function(){e.videoShareBtn2.active=!1})},prepareRelive:function(){i.instance.reliveTimes++,this.hide(),i.instance.playerRelive(),this.prepareRelivePanel.show()},backToMainMenu:function(){a.instance.destroyBannerAd(),cc.director.loadScene("mainMenu",function(){a.instance.createBannerAd(),a.instance.gameState=n.GameState.MainMenu})},hide:function(){this.node.active=!1}}),cc._RF.pop()},{"./AppMain":"AppMain","./Game":"Game","./GameDef":"GameDef"}],ScorllListView:[function(e,t){"use strict";cc._RF.push(t,"29351Mz7YtHTK/k4WhWR0Qg","ScorllListView"),cc.Class({extends:cc.Component,properties:{scrollView:{default:null,type:cc.ScrollView},itemWidth:100,itemHeight:100,itemCountPerLine:1,xSpace:0,ySpace:0,bufferZone:0},onLoad:function(){this.content=this.scrollView.content,this.items=[],this.updateTimer=0,this.updateInterval=.2,this.lastContentPosY=0},clear:function(){this.items=[],this.content.destroyAllChildren(),this.content.removeAllChildren()},init:function(){if(this.totalCount=this.items.length,!(this.totalCount<1)){this.content.height=this.totalCount/this.itemCountPerLine*(this.itemHeight+this.ySpace)+this.ySpace;for(var e=0,t=0,n=0,i=0,a=-.5*(this.itemCountPerLine*this.itemWidth+(this.itemCountPerLine-1)*this.xSpace)+.5*this.itemWidth,s=0;s<this.totalCount;++s){e=Math.floor(s/this.itemCountPerLine),t=s%this.itemCountPerLine;var o=this.items[s];this.content.addChild(o),n=a+t*(o.width+this.xSpace),i=-o.height*(.5+e)-this.ySpace*(e+1),o.setPosition(n,i)}}},scrollTo:function(e){this.scrollView.scrollToOffset(e,.7)},getPositionInView:function(e){var t=e.parent.convertToWorldSpaceAR(e.position);return this.scrollView.node.convertToNodeSpaceAR(t)},update:function(e){if(this.updateTimer+=e,!(this.updateTimer<this.updateInterval)){this.updateTimer=0;for(var t=this.items,n=this.bufferZone,i=this.scrollView.content.y<this.lastContentPosY,a=(this.itemHeight+this.ySpace)*t.length,s=0;s<t.length;++s){var o=this.getPositionInView(t[s]);i?o.y<-n&&t[s].y+a<0&&(t[s].y=t[s].y+a,t[s].getComponent("LevelItem")):o.y>n&&t[s].y-a>-this.content.height&&(t[s].y=t[s].y-a,t[s].getComponent("LevelItem"))}this.lastContentPosY=this.scrollView.content.y}},addItem:function(){this.content.height=(this.totalCount+1)*(this.itemHeight+this.ySpace)+this.ySpace,this.totalCount=this.totalCount+1},removeItem:function(){this.totalCount-1<30?cc.error("can't remove item less than 30!"):(this.content.height=(this.totalCount-1)*(this.itemHeight+this.ySpace)+this.ySpace,this.totalCount=this.totalCount-1)}}),cc._RF.pop()},{}],Stone:[function(e,t){"use strict";cc._RF.push(t,"33f17VBrLBB7on5WqDKQuZB","Stone"),cc.Class({extends:cc.Component,properties:{typeId:{default:0},originRadius:44,xpos:{default:0,visible:!1},ypos:{default:0,visible:!1},scale:{default:1,visible:!1},radius:{default:44,visible:!1}}}),cc._RF.pop()},{}],Util:[function(e,t){"use strict";cc._RF.push(t,"d4146gvBG9K0Khzl+cPUy6g","Util");var n=function(){function e(){}return e.randNumber=function(e){return Math.floor(Math.random()*e+1)},e.randRangeNumber=function(e,t){var n=t-e;return e+Math.round(Math.random()*n)},e.randRangeExclude=function(t,n,i){if(t===n)return t;for(var a=e.randRangeNumber(t,n);a===i;)a=e.randRangeNumber(t,n);return a},e.randExtract=function(t,n,i){void 0===i&&(i=!1);for(var a=[];a.length<n;){for(var s=e.randNumber(t),o=!1,r=0;r<a.length;r++)if(a[r]===s){o=!0;break}!1===o&&a.push(s)}return i&&a.sort(function(e,t){return e-t}),a},e}();t.exports=n,cc._RF.pop()},{}],VideoRecord:[function(e,t,n){"use strict";cc._RF.push(t,"3c80eiTN6VDQrGRSZK5AQaJ","VideoRecord"),n.__esModule=!0,n.default=void 0;var i=function(){function e(){var e=this;this.recorder=tt.getGameRecorderManager(),this.clipPath="",this.recorder.onStart(function(){console.log("tt record start"),e.recorder.recordClip({timeRange:[1,59]})}),this.recorder.onPause(function(){console.log("tt record pause")}),this.recorder.onResume(function(){console.log("tt record resume")}),this.recorder.onStop(function(t){console.log("tt record stop"),e.recorder.clipVideo({path:t.videoPath,success:function(t){e.clipPath=t.videoPath,console.log("ClipV success="+e.clipPath)}})}),this.recorder.onError(function(){console.log("tt record error")}),this.recorder.onInterruptionBegin(function(){console.log("tt record onInterruptionBegin")}),this.recorder.onInterruptionEnd(function(){console.log("tt record onInterruptionEnd")})}var t=e.prototype;return t.getClipPath=function(){return this.clipPath},t.shareClip=function(e){void 0===e&&(e=null),console.log("CLIPPATH="+this.clipPath),""!==this.clipPath&&(console.log("tt.shareVideo"),tt.shareVideo({videoPath:this.clipPath,success:function(){console.log("\u89c6\u9891\u5206\u4eab\u6210\u529f"),null!==e&&e()},fail:function(){console.log("\u89c6\u9891\u5206\u4eab\u5931\u8d25")},extra:{createChallenge:!1}}))},t.start=function(e){void 0===e&&(e=60),this.recorder.start({duration:e})},t.stop=function(){this.recorder.stop()},e}();n.default=i,t.exports=n.default,cc._RF.pop()},{}],Water:[function(e,t){"use strict";cc._RF.push(t,"e60b95xx7VP+IEamuWCl6Bw","Water");var n=e("./AppMain"),i=e("./Game");cc.Class({extends:cc.Component,properties:{waveSpeed:150,waveDir:-1},onLoad:function(){this.riseSpeed=150,this.spriteNode=this.node.children[0]},start:function(){},getHeight:function(){return this.spriteNode.height},setHeight:function(e){for(var t=0;t<this.node.childrenCount;t++)this.node.children[t].height=e},reset:function(){this.riseSpeed=150,this.node.y=0;for(var e=0;e<this.node.childrenCount;e++)this.node.children[e].height=100},update:function(e){if(-1===this.waveDir?(this.node.x-=this.waveSpeed*e,this.node.x<=-n.instance.designResolutionWidth&&(this.node.x=0)):(this.node.x+=this.waveSpeed*e,this.node.x>=0&&(this.node.x=-n.instance.designResolutionWidth)),n.instance.gameStarted){for(var t=0;t<this.node.childrenCount;t++)this.node.children[t].height+=this.riseSpeed*e;var a=i.instance.stonesNode.parent;this.node.y=a.y}}}),cc._RF.pop()},{"./AppMain":"AppMain","./Game":"Game"}],"use_v2.0.x_cc.Toggle_event":[function(e,t){"use strict";cc._RF.push(t,"3982b+fMUdB947OvZ4TgHSt","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["AnimCallback","AppMain","Audio","CoinEffect","DailyAwardPage","DataStorage","Game","GameDef","GoldAmount","MainMenu","Platform","Player","PrepareRelive","RankItem","RankPanel","ResultPanel","ScorllListView","Stone","Util","VideoRecord","Water","LogoAnimCallback","use_v2.0.x_cc.Toggle_event"]);